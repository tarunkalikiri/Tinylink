<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TinyLink Stats</title>
<style>
body { font-family: Arial; padding: 20px; max-width: 600px; margin:auto; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #aaa; padding: 6px; text-align: left; }
button { padding: 4px 8px; margin:2px; }
</style>
</head>
<body>
<h1>TinyLink Stats</h1>
<form id="searchForm">
  <input type="text" id="codeInput" placeholder="Enter short code" required>
  <button type="submit">Get Stats</button>
</form>
<p id="msg" style="color:red"></p>
<table id="statsTable" style="display:none;">
  <thead><tr><th>Code</th><th>URL</th><th>Clicks</th><th>Last Clicked</th><th>Created At</th></tr></thead>
  <tbody id="statsBody"></tbody>
</table>

<script>
document.getElementById("searchForm").onsubmit = async function(e){
  e.preventDefault();
  const code = document.getElementById("codeInput").value;
  const res = await fetch("/api/links/"+code);
  const data = await res.json();
  const msg = document.getElementById("msg");
  const table = document.getElementById("statsTable");
  const tbody = document.getElementById("statsBody");
  if(res.ok){
    msg.textContent="";
    table.style.display="table";
    tbody.innerHTML=`<tr>
      <td>${data.code}</td>
      <td>${data.url}</td>
      <td>${data.clicks}</td>
      <td>${data.last_clicked||'-'}</td>
      <td>${data.created_at}</td>
    </tr>`;
  } else {
    table.style.display="none";
    msg.textContent=data.error;
  }
};
</script>
</body>
</html>
